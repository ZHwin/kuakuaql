# 青龙面板使用说明

## 📌 重要提示

**青龙面板 2.14+ 版本使用 Node.js 18+，不兼容 got 库！**

本脚本已自动适配，使用 axios 替代 got，无需担心兼容性问题。

## 🚀 快速开始

### 1. 安装依赖

进入青龙面板 → 依赖管理 → NodeJs，添加以下依赖（一行一个）：

```
axios
request
tough-cookie
crypto-js
```

**注意**: 
- ❌ **不要安装 got**（会导致错误）
- ✅ 只需安装 axios 即可

### 2. 上传脚本

将以下文件上传到青龙面板的脚本目录：
- `jlyh.js` - 吉利银河
- `ljzf.js` - 霖久智服
- `xmh.js` - 星妈会
- `xmyx.js` - 星妈优选
- `sendNotify.js` - 通知模块（必需）
- `utils.js` - 工具函数（如果有）

### 3. 配置环境变量

在青龙面板 → 环境变量中添加：

#### 吉利银河 (jlyh.js)
```
名称: jlyh
值: refreshToken值&deviceSN值
```

#### 霖久智服 (ljzf.js)
```
名称: G_ljzfhd
值: 手机号
备注: 多账号用 & 或换行分隔
```

#### 星妈会 (xmh.js)
```
名称: XMH_COOKIE
值: cuk值
备注: 多账号换行分隔，可添加 # 备注
```

#### 星妈优选 (xmyx.js)
```
名称: xmyx_data
值: token值
备注: 多账号换行分隔
```

### 4. 设置定时任务

在青龙面板 → 定时任务中添加：

```bash
# 吉利银河 - 每天 8:15 执行
15 8 * * * jlyh.js

# 霖久智服 - 每天 9:00 执行
0 9 * * * ljzf.js

# 星妈会 - 每天 10:00 执行
0 10 * * * xmh.js

# 星妈优选 - 每天 0:30 执行
30 0 * * * xmyx.js
```

### 5. 配置通知（可选）

编辑 `sendNotify.js` 文件，配置你的推送渠道：

```javascript
const push_config = {
  // Server酱
  PUSH_KEY: '你的PUSH_KEY',
  
  // Bark
  BARK_PUSH: 'https://api.day.app/你的设备码/',
  
  // 企业微信机器人
  QYWX_KEY: '你的webhook地址',
  
  // Telegram Bot
  TG_BOT_TOKEN: '你的bot_token',
  TG_USER_ID: '你的user_id',
  
  // PushPlus
  PUSH_PLUS_TOKEN: '你的token',
  
  // 更多推送方式请查看文件内注释
};
```

或者在青龙面板的环境变量中配置（推荐）：
```
PUSH_KEY=你的PUSH_KEY
BARK_PUSH=https://api.day.app/你的设备码/
```

## ⚠️ 常见问题

### 1. 报错：`got is not a function`
**原因**: 安装了 got 库导致冲突

**解决方案**:
1. 进入青龙面板 → 依赖管理 → NodeJs
2. 找到 `got` 并删除
3. 确保已安装 `axios`
4. 重新运行脚本

### 2. 报错：`Cannot find module 'axios'`
**原因**: 未安装 axios

**解决方案**:
1. 进入青龙面板 → 依赖管理 → NodeJs
2. 添加 `axios`
3. 点击安装

### 3. 通知发送失败
**原因**: 
- 未配置推送渠道
- axios 未安装

**解决方案**:
- 检查 sendNotify.js 中的推送配置
- 确保已安装 axios
- 或在脚本中设置 `Notify = 0` 关闭通知

### 4. 脚本运行但无输出
**原因**: 环境变量配置错误

**解决方案**:
- 检查环境变量名称是否正确
- 检查环境变量值格式是否正确
- 查看青龙面板日志获取详细错误信息

## 📝 版本兼容性

| 青龙版本 | Node.js 版本 | got 库 | axios 库 | 本脚本 |
|---------|-------------|--------|----------|--------|
| 2.13.x  | 16.x        | ✅ v11  | ✅       | ✅     |
| 2.14.x+ | 18.x+       | ❌      | ✅       | ✅     |
| 2.15.x+ | 20.x+       | ❌      | ✅       | ✅     |

**结论**: 无论哪个版本的青龙面板，本脚本都能正常运行！

## 🔧 手动测试

在青龙面板中手动运行脚本测试：

```bash
# 进入容器
docker exec -it qinglong bash

# 进入脚本目录
cd /ql/scripts

# 测试运行
node jlyh.js
node ljzf.js
node xmh.js
node xmyx.js
```

## 📞 技术支持

如遇到问题：
1. 查看青龙面板的运行日志
2. 检查环境变量配置
3. 确认依赖已正确安装
4. 提交 Issue 并附上错误日志

---

**祝使用愉快！** 🎉
